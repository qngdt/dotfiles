# Enable Powerlevel10k instant prompt (MUST be at top)
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# PATH
export PATH="$HOME/.local/bin:$PATH"

# zsh-vi-mode configuration (must be before loading plugins)
function zvm_config() {
  ZVM_INIT_MODE=sourcing
  ZVM_VI_INSERT_ESCAPE_BINDKEY=jk
}
function zvm_after_init() {
  source <(fzf --zsh)
}

# Load Antidote
source /opt/homebrew/opt/antidote/share/antidote/antidote.zsh
antidote load

# mise (version manager - not a zsh plugin)
eval "$(mise activate zsh)"

# Language/locale
export LANG="en_US.UTF-8"
export LC_ALL="en_US.UTF-8"
export LC_CTYPE="en_US.UTF-8"

# Git
export GIT_EDITOR=vim
__git_files () {
    _wanted files expl 'local files' _files
}

# Use nvim as the default if available
if type nvim > /dev/null 2>&1; then
  export EDITOR='nvim'
fi

# Aliases
if type nvim > /dev/null 2>&1; then
  alias vim='nvim'
fi

alias lg="lazygit"
alias ld="lazydocker"
alias rm="rm -iv" # because I'm an idiot sandwich

alias gP='git push'
alias ga='git add'
alias gc='git commit'
alias gco='git checkout'
alias gd='git diff'
alias gp='git pull'
alias gst='git status'

alias k='kubectl'

# Local credentials and config
[[ -f ~/.env.local ]] && source ~/.env.local
[[ -f ~/.zshrc.local ]] && source ~/.zshrc.local

# Powerlevel10k config
[[ -f ~/.p10k.zsh ]] && source ~/.p10k.zsh
